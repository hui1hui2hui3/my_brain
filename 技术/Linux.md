---
tag: ["Linux"]
---

## 命令
### grep
> 流式读取文件，省内存；判断是否满足条件进行文字行的抓取
> 适合单纯的文本查找

**常用参数：**
|参数|描述|
|----|----|
|-n|显示行号|
|-e/E|使用正则表达式匹配搜索|
|-B|-B num 显示目标的前面几行|
|-A|-A num 显示目标的后面几行|

**常见语法：**
```shell
grep "target" test.txt
grep -n "target" test.txt
grep -e "t.*t" test.txt
grep -n -A 3 -B 3 "target" test.txt
```

### sed
> 查找、编辑文本，以行为单位进行操作；核心：找谁干啥；
> 适合编辑匹配的文本

**常用参数：**
|参数|描述|
|----|----|
|-n|仅显示动作处理后的结果，不显示源文件；一般和动作p同时出现|
|//|正则表达语法，需要在''中使用|
|s/搜索串/替换串/g|搜索替换，需要在''中使用，搜索串中`^`表示行开始，`$`表示行结尾|


**核心动作：**
打印(p)，行前插入(i)，当前行替换(c)，当前行删除(d)，行后新增(a)
动作不改变真实文件的内容，除非写入到文件中去

**核心变量：**
|变量名|描述|
|----|----|
|$|表示文件最后一行，主要在''中使用才可|

**常见语法：**
```shell
sed -n 3p test.txt #打印第三行，单行
sed -n 2,5p test.txt #打印第2-5行的内容，多行
sed -n '$p' test.txt #打印最后一行，变量行
sed 3p test.txt #打印所有内容，且第三行重复打印一次
sed 3a\test test.txt #打印所有内容，并且在第三行之后，新增 test一行的文本
sed '3a test' test.txt #打印所有内容，并且在第三行之后，新增 test一行的文本

sed '2,$d' test.txt #删除除第一行之外的所有行，只打印出第一行
sed '1,100c haha' test.txt #将第1-100行替换为haha

sed -n '/Bean.*/p' test.txt #打印出含有Bean的行
```

### awk
> 文本处理语言，算是一门脚本语言；可以精确处理到列
> 适合格式化文本，更加精确更加复杂的处理

**基础语法：**`awk -F[分隔符] 'BEGIN{动作} [过滤条件]{动作} END{动作}' 输入文件`

**常用参数：**
|参数|描述|
|----|----|
|-F|指定列分割符号，默认为空格|
|-v|定义变量|

**脚本语法：所有脚本要在'{}'中编写**
|参数|描述|
|----|----|
|print|打印指定列，$1表示第一列|
|/正则表达式/|正则表达式匹配|
|BEGIN{代码}|处理开始前执行的脚本|
|END{代码}|处理结束后执行的脚本|
|{代码}|这里是处理每一行都要执行的脚本|

**内置变量：**
|参数|描述|
|----|----|
|$0|表示完整行|
|$n|表示最后一列|
|OFS|输出的分隔符，默认为空格|
|NR|行号|

**常用语法：**
```shell
awk -F: '{print $1,$3}' test.txt #打印第1和第3列，注意不是1-3列
awk -va=1 '{print a}' test2.txt #打印a，有多少行，打印多少个a
awk -F: '$1>2{print $1,$2,$3}' test2.txt #打印第一列值大于2的所有列
awk -F: '$1>2{print $0}' test2.txt #打印第一列值大于2的所有列

awk -F: '$1>2{print NR,$0}' test2.txt #打印第一列值大于2的所有列，同时显示行号
awk -F: '$1>1{print NR,$n}' OFS='$' test2.txt #打印第一列值大于2的所有列，同时显示行号,并且$分割显示

awk /b/ test2.txt #打印行匹配b的内容

awk -F: 'BEGIN{sum=0}{sum+=$1;print sum}' test2.txt #计算第一列相加的总和，并在每次计算后打印
awk -F: 'BEGIN{sum=0}{sum+=$1}END{print sum}' test2.txt #计算第一列相加的综合，并最后打印一次
awk -F: '{if($1%2==0) print $0}' test2.txt #打印如果第一列为偶数的行
awk 'BEGIN {for(i=0;i<5;i++) print i}' #for循环打印0-4
```